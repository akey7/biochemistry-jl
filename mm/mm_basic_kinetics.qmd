---
title: "Michaelis-Menten Kinetics"
format:
  html:
    toc: true
    html-math-method: mathjax
    code-fold: true
---

```{julia}
#| label: using-things
#| eval: true
#| include: false

using Printf
using Plots
plotlyjs()
```

## Chemical and Rate Equations and Units

Reaction:

$$ E + S \leftrightharpoons ES \rightarrow E + P$$

Reversible rates are k<sub>+1</sub> and k<sub>-1</sub>. The final irreversible step has rate k<sub>cat</sub>.

[See Wikipedia for details](https://en.wikipedia.org/wiki/Michaelis%E2%80%93Menten_kinetics#Model).

Rate equation:
$$ {d[P] \over dt} = {V_{\max}[S] \over K_M + [S]} $$

| Variable | Units | Meaning |
|---|---|---|
| d[P]/dt | s<sup>-1</sup> | Rate of formation of product |
| V<sub>max</sub> | s<sup>-1</sup> | Maximum possible rate of product formation |
| [S] | M | Concentration of substrate |
| K<sub>M</sub> | M | Concentration of substrate at 1/2 V<sub>max</sub> |

## Plot d[P]/dt vs. [S]

```{julia}
#| label: make-plot
#| eval: true
#| include: true

vmax = 1.0e-4
km = 1.0e-3
substrate_concentrations = collect(range(start=0, stop=7.5e-3, length=100))

function mm(substrate_concentration)
    vmax * substrate_concentration / (km + substrate_concentration)
end

dP_dts = mm.(substrate_concentrations)
dP_dt_max = maximum(dP_dts)

xtick_vals = range(start=0, stop=maximum(substrate_concentrations), length=5)  # Example x-tick positions
xtick_labels = [@sprintf("%.4f", val) for val in xtick_vals]

plot(substrate_concentrations, dP_dts, xlabel="[S] (M)", ylabel="d[P]/dt (M/min)", xticks=(xtick_vals, xtick_labels))
```
